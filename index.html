<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Task Taxonomy Tool for Higher Education (Multi-Step)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- html2pdf.js script is no longer strictly necessary but harmless if left -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
     <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">


    <style>
        /* Base styles remain the same */
        body { font-family: 'Inter', sans-serif; background-color: #f9fafb; }
        .main-container { max-width: 6xl; margin-left: auto; margin-right: auto; background-color: white; padding: 1.5rem 2rem; border-radius: 0.75rem; box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); }
        .page { display: none; } .page.active { display: block; }
        summary { cursor: pointer; font-weight: 500; color: #4f46e5; margin-bottom: 0.5rem; display: inline-block; } summary:hover { color: #4338ca; } summary::marker { content: '▶ '; font-size: 0.8em; } details[open] summary::marker { content: '▼ '; }
        #resultBox { border-left-width: 4px; padding: 1.5rem; margin-top: 1.5rem; border-radius: 0.375rem; box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1); }
        .result-human-led { border-color: #ef4444; background-color: #fee2e2; } .result-ai-assisted { border-color: #f97316; background-color: #ffedd5; } .result-high-automation { border-color: #84cc16; background-color: #ecfccb; } .result-full-automation { border-color: #22c55e; background-color: #dcfce7; } .result-default { border-color: #6b7280; background-color: #f3f4f6; }
        textarea { min-height: 70px; }
        .diagram-box { border: 1px solid #d1d5db; padding: 0.75rem 1rem; border-radius: 0.375rem; text-align: center; font-size: 0.875rem; background-color: #f8fafc; box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05); min-height: 60px; display: flex; align-items: center; justify-content: center; font-weight: 500; } .diagram-arrow { font-size: 1.5rem; color: #9ca3af; display: flex; align-items: center; justify-content: center; margin: 0 0.5rem; }
        .evaluation-page fieldset { background-color: #f9fafb; border: 1px solid #e5e7eb; box-shadow: 0 2px 4px 0 rgb(0 0 0 / 0.05); margin-bottom: 2rem; padding: 1.5rem 2rem; border-radius: 0.5rem; } .evaluation-page .fieldset-legend { font-size: 1.25rem; font-weight: 700; color: #3730a3; padding: 0 0.5rem; margin-bottom: 0.75rem; } .evaluation-page .dimension-description { font-size: 1rem; font-weight: 400; color: #4b5563; margin-bottom: 2rem; padding: 0.5rem; line-height: 1.6; background-color: #eef2ff; border-left: 4px solid #6366f1; border-radius: 0.25rem; }
        input:focus, select:focus, textarea:focus { border-color: #4f46e5; box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.3); outline: none; }
        .action-button { padding: 0.75rem 1.75rem; font-size: 1rem; font-weight: 600; border-radius: 0.5rem; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); transition: all 0.2s ease-in-out; cursor: pointer; display: inline-block; text-align: center; } .submit-button { background-color: #3b82f6; color: white; } .submit-button:hover { background-color: #2563eb; } .submit-button:focus { ring: 2px; ring-offset: 2px; ring-blue-500;} .export-button { background-color: #10b981; color: white; } .export-button:hover { background-color: #059669; } .export-button:focus { ring: 2px; ring-offset: 2px; ring-emerald-500;} .nav-button { background-color: #4f46e5; color: white; } .nav-button:hover { background-color: #4338ca; } .nav-button:focus { ring: 2px; ring-offset: 2px; ring-indigo-500;} .back-button { background-color: #6b7280; color: white; } .back-button:hover { background-color: #4b5563; } .back-button:focus { ring: 2px; ring-offset: 2px; ring-gray-500;} .page-navigation { margin-top: 2.5rem; display: flex; justify-content: space-between; align-items: center; }
        .evaluation-page .question-item { margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px dashed #d1d5db; } .evaluation-page .question-item:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; } .evaluation-page .question-label { display: block; font-weight: 600; color: #1f2937; margin-bottom: 0.5rem; font-size: 1.05rem; } .evaluation-page .question-description { font-size: 0.85rem; color: #6b7280; margin-bottom: 1rem; } .evaluation-page .scale-container { display: flex; flex-wrap: wrap; gap: 0.75rem 2rem; align-items: center; background-color: #f8fafc; padding: 1rem; border-radius: 0.375rem; border: 1px solid #f0f0f0; margin-top: 0.5rem; } .evaluation-page .scale-container label { margin-right: 0.5rem; font-size: 0.9rem; color: #374151; cursor: pointer; transition: color 0.2s; } .evaluation-page .scale-container label:hover { color: #4f46e5; } .evaluation-page .scale-container input[type="radio"] { margin-right: 0.35rem; cursor: pointer; width: 1.1em; height: 1.1em; accent-color: #4f46e5; } .evaluation-page .scale-container input[type="radio"]:focus { ring: 2px; ring-offset: 1px; ring-indigo-500; }
        .stakeholder-group label { display: flex; align-items: center; margin-bottom: 0.5rem; } #otherStakeholderInput { margin-top: 0.5rem; }
        .evaluation-page .dimension-score-display { margin-top: 1.5rem; padding: 0.75rem 1.25rem; background-color: #e0e7ff; border: 1px solid #a5b4fc; border-radius: 0.375rem; text-align: center; font-weight: 600; color: #3730a3; font-size: 1.05rem; } .evaluation-page .dimension-score-display .score-value { font-weight: 700; margin-left: 0.75rem; }
        #stakeholderPrompts { font-size: 0.875rem; color: #1d4ed8; background-color: #eff6ff; border-left: 3px solid #3b82f6; padding: 0.75rem; margin-top: 1rem; border-radius: 0.25rem; } #stakeholderPrompts ul { list-style-type: disc; margin-left: 1.5rem; }
        .progress-indicator { text-align: center; margin-bottom: 1.5rem; padding: 0.5rem; background-color: #f3f4f6; border-radius: 0.25rem; font-size: 0.9rem; color: #4b5563; font-weight: 500; }
        #radarChartContainer { max-width: 500px; margin: 2rem auto; padding: 1rem; background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 0.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.08); }
        .info-icon { color: #a5b4fc; cursor: pointer; margin-left: 0.5rem; font-size: 0.9em; transition: color 0.2s; } .info-icon:hover { color: #6366f1; } .info-tooltip { position: absolute; background-color: #1f2937; color: #fff; padding: 0.5rem; border-radius: 0.25rem; font-size: 0.75rem; max-width: 250px; z-index: 10; pointer-events: none; opacity: 0; transition: opacity 0.2s ease-in-out; transform: translateX(-50%); left: 50%; bottom: 1.5rem; } .info-icon-container { position: relative; display: inline-block; } .info-icon-container:hover .info-tooltip { opacity: 1; }

        /* Specific styles for the printable report HTML */
        .printable-report { font-family: sans-serif; padding: 20px; color: #333; background: white; max-width: 8.5in; margin: 0 auto; /* Center content for printing */ }
        .printable-report h1 { font-size: 18pt; margin-bottom: 15px; color: #111; }
        .printable-report h2 { font-size: 14pt; margin-top: 20px; margin-bottom: 10px; border-bottom: 1px solid #ccc; padding-bottom: 5px; color: #222; page-break-after: avoid; }
        .printable-report h3 { font-size: 12pt; margin-top: 15px; margin-bottom: 5px; color: #444; page-break-after: avoid; }
        .printable-report .dimension-desc-pdf { font-size: 10pt; font-weight: bold; color: #333; margin-bottom: 12px; }
        .printable-report p { font-size: 10pt; line-height: 1.4; margin-bottom: 8px; }
        .printable-report .label { font-weight: bold; }
        .printable-report .notes { font-style: italic; color: #555; margin-left: 15px; font-size: 9pt; background-color: #f8f8f8; padding: 5px; border-radius: 3px; margin-top: 5px; }
        .printable-report .result-section { margin-top: 25px; padding: 15px; border: 1px solid #ddd; background-color: #f9f9f9; page-break-inside: avoid; border-radius: 4px; }
        .printable-report .result-category { font-size: 14pt; font-weight: bold; margin-bottom: 10px; }
        .printable-report .result-rationale { font-size: 10pt; }
        .printable-report .result-disclaimer { font-size: 8pt; color: #777; margin-top: 15px; }
        .printable-report .question-block { margin-bottom: 10px; padding-bottom: 5px; border-bottom: 1px dotted #eee; page-break-inside: avoid; }
        .printable-report .question-block:last-of-type { border-bottom: none; }
        .printable-report .question-text { font-weight: bold; font-size: 10pt; margin-bottom: 2px;}
        .printable-report .question-desc-pdf { font-size: 8.5pt; color: #666; margin-bottom: 4px; }
        .printable-report .question-answer { margin-left: 10px; font-size: 10pt; }
        .printable-report .dimension-score-pdf { font-weight: bold; font-size: 11pt; margin-top: 5px; color: #0056b3; text-align: right; }
        .printable-report .stakeholder-list-pdf { margin-top: 5px; font-size: 10pt; }
        .printable-report .chart-container-pdf { width: 100%; max-width: 450px; margin: 20px auto; page-break-inside: avoid; text-align: center; }
        .printable-report .chart-container-pdf img { max-width: 100%; height: auto; display: inline-block; }
        /* Simple print-specific styles */
        @media print {
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } /* Ensure colors print */
            .no-print { display: none; } /* Class to hide elements in print view */
            a { text-decoration: none; color: inherit; } /* Avoid underlines/blue links */
            .printable-report { box-shadow: none; border: none; margin: 0; max-width: 100%; }
        }

        .hidden { display: none !important; }
        /* Landing Page Styles remain the same */
        #landingPage h1 { color: #3730a3; } #landingPage .intro-paragraph { font-size: 1.125rem; color: #4b5563; } .landing-section { margin-bottom: 2.5rem; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); } .landing-card { padding: 1rem; background-color: white; border-radius: 0.375rem; border: 1px solid #e5e7eb; transition: all 0.2s ease-in-out; } .landing-card:hover { box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); border-color: #a5b4fc; transform: translateY(-2px); } .landing-card strong { color: #4338ca; }

    </style>
</head>
<body class="bg-gray-50 p-4 md:p-8">
    <div class="main-container">

        <!-- Landing Page -->
        <div id="landingPage" class="page active">
             <!-- Content as before -->
            <div class="text-center mb-12"><h1 class="text-3xl md:text-4xl font-bold text-indigo-700 mb-4">AI Task Taxonomy Evaluation Framework</h1><p class="text-gray-600 text-lg md:text-xl leading-relaxed max-w-3xl mx-auto intro-paragraph">Welcome! This framework helps Higher Education staff evaluate tasks for potential AI integration. It considers the task's nature, risks, ethics, stakeholder value, human element, and feasibility to suggest an appropriate level of AI involvement.</p></div>
            <div class="landing-section bg-indigo-50 border border-indigo-100"><h2 class="text-xl font-semibold text-indigo-800 mb-5 text-center">Framework Overview</h2><div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4 mb-4"><div class="diagram-box bg-blue-100 border-blue-300 text-blue-800 font-semibold">Input:<br>Specific HEI Task</div><div class="diagram-arrow hidden md:block text-indigo-400">→</div><div class="diagram-box bg-yellow-100 border-yellow-300 text-yellow-800 font-semibold">Evaluation:<br>6 Dimensions (Scored)</div><div class="diagram-arrow hidden md:block text-indigo-400">→</div><div class="diagram-box bg-green-100 border-green-300 text-green-800 font-semibold">Output:<br>4 Categories</div></div><p class="text-center text-indigo-700 mt-4 text-sm md:text-base">The evaluation across the six dimensions leads to a suggested category: Human-Led, AI-Assisted, High Automation Potential, or Full Automation.</p></div>
            <div class="landing-section bg-blue-50 border border-blue-100"><h2 class="text-xl font-semibold text-blue-800 mb-5 text-center">The Six Dimensions</h2><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 text-sm text-gray-700"><div class="landing-card"><strong>1. Task Nature & Complexity:</strong> Characteristics like repetitiveness, cognitive load, data needs, and creativity requirements.</div><div class="landing-card"><strong>2. Risk, Safety & Security:</strong> Potential harms like data breaches, bias, safety issues, and integrity concerns.</div><div class="landing-card"><strong>3. Ethical Considerations:</strong> Alignment with fairness, transparency, accountability, and human dignity.</div><div class="landing-card"><strong>4. Stakeholder Value & Impact:</strong> Potential benefits or drawbacks for students, staff, and the institution.</div><div class="landing-card"><strong>5. Human Element Requirement:</strong> Need for empathy, mentorship, nuanced judgment, or complex communication.</div><div class="landing-card"><strong>6. Feasibility & Implementation:</strong> Practical aspects like tech maturity, data, cost, skills, and policy.</div></div></div>
            <div class="landing-section bg-green-50 border border-green-100"><h2 class="text-xl font-semibold text-green-800 mb-5 text-center">What the Four Suggested Categories Mean</h2><div class="grid grid-cols-1 md:grid-cols-2 gap-5 text-sm text-gray-700"><div class="landing-card"><strong>Human-Led (No / Minimal AI)</strong><br>High-risk, ethically sensitive or empathy-heavy tasks. AI may provide very limited support, but humans stay fully responsible.</div><div class="landing-card"><strong>AI-Assisted (Human in Control)</strong><br>AI speeds up or augments parts of the work, yet humans still steer decisions and remain accountable throughout.</div><div class="landing-card"><strong>High Automation Potential (Human Supervising)</strong><br>Most steps can run automatically, but routine human oversight is advisable for edge cases, quality assurance and accountability.</div><div class="landing-card"><strong>Full Automation (Minimal Oversight Post-Setup)</strong><br>Well-defined, low-risk and repeatable tasks suitable for end-to-end automation once properly configured and periodically monitored.</div></div></div>
            <div class="text-center mt-10"><button data-target-page="taskIdentificationPage" class="action-button nav-button text-lg px-12 py-3 navigate-button bg-indigo-600 hover:bg-indigo-700 focus:ring-indigo-500">Start Task Identification →</button></div>
        </div>

        <!-- Task Identification Page -->
        <div id="taskIdentificationPage" class="page" data-page-index="1">
             <!-- Content as before -->
             <div class="progress-indicator">Step 1 of 9: Task Identification</div><h1 class="text-2xl md:text-3xl font-bold text-gray-900 mb-4 text-center">Task Identification</h1><p class="text-gray-600 mb-8 text-center">Define the task you want to evaluate and identify the key stakeholders involved.</p><form id="taskIdentificationForm" class="space-y-8"><fieldset class="border border-gray-300 p-5 rounded-md"><legend class="fieldset-legend">Task Details</legend><div class="grid grid-cols-1 md:grid-cols-2 gap-5 mt-2"><div><label for="taskName" class="block text-sm font-medium text-gray-700 mb-1">Task Name:</label><input type="text" id="taskName" name="taskName" required placeholder="e.g., Grading MCQs for Intro Course" class="w-full p-2.5 border border-gray-300 rounded-md shadow-sm"></div><div><label for="evaluator" class="block text-sm font-medium text-gray-700 mb-1">Evaluator(s):</label><input type="text" id="evaluator" name="evaluator" placeholder="e.g., John Doe, Curriculum Committee" class="w-full p-2.5 border border-gray-300 rounded-md shadow-sm"></div><div><label for="evalDate" class="block text-sm font-medium text-gray-700 mb-1">Date:</label><input type="date" id="evalDate" name="evalDate" required class="w-full p-2.5 border border-gray-300 rounded-md shadow-sm"></div><div class="md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-2">Key Stakeholder Groups Involved:</label><div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-x-4 gap-y-2 stakeholder-group"><label><input type="checkbox" name="stakeholder" value="Students" class="mr-2"> Students</label><label><input type="checkbox" name="stakeholder" value="Faculty" class="mr-2"> Faculty / Instructors</label><label><input type="checkbox" name="stakeholder" value="Admin Staff" class="mr-2"> Administrative Staff</label><label><input type="checkbox" name="stakeholder" value="IT Staff" class="mr-2"> IT Staff</label><label><input type="checkbox" name="stakeholder" value="Researchers" class="mr-2"> Researchers</label><label><input type="checkbox" id="stakeholderOtherCheck" name="stakeholder" value="Other" class="mr-2"> Other</label></div><input type="text" id="otherStakeholderInput" name="otherStakeholderText" placeholder="Specify other stakeholders" class="w-full p-2.5 border border-gray-300 rounded-md shadow-sm mt-2 hidden"></div></div></fieldset><div class="page-navigation"><button type="button" data-target-page="landingPage" class="action-button back-button navigate-button">← Back to Description</button><button type="button" data-target-page="evaluationPage_Nature" id="goToEvaluationButton" class="action-button nav-button navigate-button">Proceed to Dimension 1 →</button></div></form>
        </div>

        <!-- Evaluation Pages (Nature, Risk, Ethics, Value, Human, Feasibility) - WITH UI improvements -->
        <div id="evaluationPage_Nature" class="page evaluation-page" data-page-index="2">
             <div class="progress-indicator">Step 2 of 9: Task Nature & Complexity</div>
             <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 text-center">Dimension 1: Task Nature & Complexity</h1>
            <form class="dimension-form space-y-8"> <fieldset data-dimension="nature"> <legend class="fieldset-legend">Evaluation Questions</legend> <p class="dimension-description">The inherent characteristics of the task itself, such as how repetitive, data-driven, or creative it is. This helps determine its baseline suitability for automation.</p> <div class="question-item"> <span class="question-label">Repetitiveness <span class="info-icon-container"><i class="fas fa-info-circle info-icon"></i><span class="info-tooltip">...</span></span></span> <p class="question-description">How routine and predictable is the task?...</p> <div class="scale-container"> <label><input type="radio" name="nature_repetitiveness" value="1" required> 1: Highly Variable</label> <label><input type="radio" name="nature_repetitiveness" value="2"> 2: Somewhat Variable</label> <label><input type="radio" name="nature_repetitiveness" value="3"> 3: Mixed</label> <label><input type="radio" name="nature_repetitiveness" value="4"> 4: Somewhat Repetitive</label> <label><input type="radio" name="nature_repetitiveness" value="5"> 5: Highly Repetitive</label> </div> </div> <div class="question-item"> <span class="question-label">Cognitive Load <span class="info-icon-container">...</span></span> <p class="question-description">What kind of thinking is required?...</p> <div class="scale-container"> <label><input type="radio" name="nature_cognitive" value="1" required> 1: Judgment/Creative</label> <label><input type="radio" name="nature_cognitive" value="2"> 2: Analytical/Interpretive</label> <label><input type="radio" name="nature_cognitive" value="3"> 3: Mixed</label> <label><input type="radio" name="nature_cognitive" value="4"> 4: Data Analysis</label> <label><input type="radio" name="nature_cognitive" value="5"> 5: Rule-Following</label> </div> </div> <div class="question-item"> <span class="question-label">Data Dependence <span class="info-icon-container">...</span></span> <p class="question-description">How much does the task rely on processing data?...</p> <div class="scale-container"> <label><input type="radio" name="nature_data" value="1" required> 1: Low/Qualitative</label> <label><input type="radio" name="nature_data" value="2"> 2: Moderate/Mixed</label> <label><input type="radio" name="nature_data" value="3"> 3: Data Processing Needed</label> <label><input type="radio" name="nature_data" value="4"> 4: Significant Data Analysis</label> <label><input type="radio" name="nature_data" value="5"> 5: High/Structured Data</label> </div> </div> <div class="question-item"> <span class="question-label">Determinism vs. Ambiguity <span class="info-icon-container">...</span></span> <p class="question-description">How clear and unambiguous are the task inputs?...</p> <div class="scale-container"> <label><input type="radio" name="nature_ambiguity" value="1" required> 1: Highly Ambiguous</label> <label><input type="radio" name="nature_ambiguity" value="2"> 2: Somewhat Ambiguous</label> <label><input type="radio" name="nature_ambiguity" value="3"> 3: Mixed</label> <label><input type="radio" name="nature_ambiguity" value="4"> 4: Somewhat Deterministic</label> <label><input type="radio" name="nature_ambiguity" value="5"> 5: Highly Deterministic</label> </div> </div> <div class="mt-6"> <label for="notesNature" class="block text-sm font-medium text-gray-700 mb-1">Notes/Rationale for Nature & Complexity:</label> <textarea id="notesNature" name="notesNature" rows="3" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></textarea> </div> <div class="dimension-score-display mt-auto">Dimension Score (Avg):<span class="score-value" id="score_nature">N/A</span></div> </fieldset> <div class="page-navigation"> <button type="button" data-target-page="taskIdentificationPage" class="action-button back-button navigate-button">← Back</button> <button type="button" data-target-page="evaluationPage_Risk" class="action-button nav-button navigate-button">Next →</button> </div> </form>
        </div>
        <div id="evaluationPage_Risk" class="page evaluation-page" data-page-index="3">
            <div class="progress-indicator">Step 3 of 9: Risk, Safety & Security</div> <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 text-center">Dimension 2: Risk, Safety & Security</h1> <form class="dimension-form space-y-8"> <fieldset data-dimension="risk"> <legend class="fieldset-legend">Evaluation Questions</legend> <p class="dimension-description">Potential negative consequences of using AI...</p> <div class="question-item"> <span class="question-label">Data Privacy & Security Risk <span class="info-icon-container">...</span></span> <p class="question-description">How likely and severe is the potential harm...</p> <div class="scale-container"> <label><input type="radio" name="risk_privacy" value="1" required> 1: Very Low</label> <label><input type="radio" name="risk_privacy" value="2"> 2: Low</label> <label><input type="radio" name="risk_privacy" value="3"> 3: Medium</label> <label><input type="radio" name="risk_privacy" value="4"> 4: High</label> <label><input type="radio" name="risk_privacy" value="5"> 5: Very High</label> </div> </div> <div class="question-item"> <span class="question-label">Algorithmic Bias & Fairness Risk <span class="info-icon-container">...</span></span> <p class="question-description">How likely is the AI to introduce...</p> <div class="scale-container"> <label><input type="radio" name="risk_bias" value="1" required> 1: Very Low</label> <label><input type="radio" name="risk_bias" value="2"> 2: Low</label> <label><input type="radio" name="risk_bias" value="3"> 3: Medium</label> <label><input type="radio" name="risk_bias" value="4"> 4: High</label> <label><input type="radio" name="risk_bias" value="5"> 5: Very High</label> </div> </div> <div class="question-item"> <span class="question-label">Safety & Well-being Risk <span class="info-icon-container">...</span></span> <p class="question-description">Could AI errors or misuse...</p> <div class="scale-container"> <label><input type="radio" name="risk_safety" value="1" required> 1: Very Low</label> <label><input type="radio" name="risk_safety" value="2"> 2: Low</label> <label><input type="radio" name="risk_safety" value="3"> 3: Medium</label> <label><input type="radio" name="risk_safety" value="4"> 4: High</label> <label><input type="radio" name="risk_safety" value="5"> 5: Very High</label> </div> </div> <div class="question-item"> <span class="question-label">Operational & Reputational Risk <span class="info-icon-container">...</span></span> <p class="question-description">How significant is the potential disruption...</p> <div class="scale-container"> <label><input type="radio" name="risk_operational" value="1" required> 1: Very Low</label> <label><input type="radio" name="risk_operational" value="2"> 2: Low</label> <label><input type="radio" name="risk_operational" value="3"> 3: Medium</label> <label><input type="radio" name="risk_operational" value="4"> 4: High</label> <label><input type="radio" name="risk_operational" value="5"> 5: Very High</label> </div> </div> <div class="mt-6"> <label for="notesRisk" class="block text-sm font-medium text-gray-700 mb-1">Key Risks & Mitigation Notes:</label> <textarea id="notesRisk" name="notesRisk" rows="3" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></textarea> </div> <div class="dimension-score-display mt-auto">Dimension Score (Max):<span class="score-value" id="score_risk">N/A</span></div> </fieldset> <div class="page-navigation"> <button type="button" data-target-page="evaluationPage_Nature" class="action-button back-button navigate-button">← Back</button> <button type="button" data-target-page="evaluationPage_Ethics" class="action-button nav-button navigate-button">Next →</button> </div> </form>
        </div>
        <div id="evaluationPage_Ethics" class="page evaluation-page" data-page-index="4">
            <div class="progress-indicator">Step 4 of 9: Ethical Considerations</div> <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 text-center">Dimension 3: Ethical Considerations</h1> <form class="dimension-form space-y-8"> <fieldset data-dimension="ethics"> <legend class="fieldset-legend">Evaluation Questions</legend> <p class="dimension-description">Alignment with ethical principles...</p> <div class="question-item"> <span class="question-label">Fairness & Equity Concern <span class="info-icon-container">...</span></span> <p class="question-description">Does the potential use of AI raise concerns...</p> <div class="scale-container"> <label><input type="radio" name="ethics_fairness" value="1" required> 1: Very Low</label> <label><input type="radio" name="ethics_fairness" value="2"> 2: Low</label> <label><input type="radio" name="ethics_fairness" value="3"> 3: Medium</label> <label><input type="radio" name="ethics_fairness" value="4"> 4: High</label> <label><input type="radio" name="ethics_fairness" value="5"> 5: Very High</label> </div> </div> <div class="question-item"> <span class="question-label">Transparency & Explainability Concern <span class="info-icon-container">...</span></span> <p class="question-description">How difficult would it be to understand...</p> <div class="scale-container"> <label><input type="radio" name="ethics_transparency" value="1" required> 1: Very Low</label> <label><input type="radio" name="ethics_transparency" value="2"> 2: Low</label> <label><input type="radio" name="ethics_transparency" value="3"> 3: Medium</label> <label><input type="radio" name="ethics_transparency" value="4"> 4: High</label> <label><input type="radio" name="ethics_transparency" value="5"> 5: Very High</label> </div> </div> <div class="question-item"> <span class="question-label">Accountability & Responsibility Concern <span class="info-icon-container">...</span></span> <p class="question-description">How clear is it who would be responsible...</p> <div class="scale-container"> <label><input type="radio" name="ethics_accountability" value="1" required> 1: Very Low</label> <label><input type="radio" name="ethics_accountability" value="2"> 2: Low</label> <label><input type="radio" name="ethics_accountability" value="3"> 3: Medium</label> <label><input type="radio" name="ethics_accountability" value="4"> 4: High</label> <label><input type="radio" name="ethics_accountability" value="5"> 5: Very High</label> </div> </div> <div class="question-item"> <span class="question-label">Human Dignity & Autonomy Concern <span class="info-icon-container">...</span></span> <p class="question-description">Does the AI's potential role respect human agency...</p> <div class="scale-container"> <label><input type="radio" name="ethics_dignity" value="1" required> 1: Very Low</label> <label><input type="radio" name="ethics_dignity" value="2"> 2: Low</label> <label><input type="radio" name="ethics_dignity" value="3"> 3: Medium</label> <label><input type="radio" name="ethics_dignity" value="4"> 4: High</label> <label><input type="radio" name="ethics_dignity" value="5"> 5: Very High</label> </div> </div> <div class="mt-6"> <label for="notesEthics" class="block text-sm font-medium text-gray-700 mb-1">Key Ethical Issues & Safeguard Notes:</label> <textarea id="notesEthics" name="notesEthics" rows="3" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></textarea> </div> <div class="dimension-score-display mt-auto">Dimension Score (Max):<span class="score-value" id="score_ethics">N/A</span></div> </fieldset> <div class="page-navigation"> <button type="button" data-target-page="evaluationPage_Risk" class="action-button back-button navigate-button">← Back</button> <button type="button" data-target-page="evaluationPage_Value" class="action-button nav-button navigate-button">Next →</button> </div> </form>
        </div>
        <div id="evaluationPage_Value" class="page evaluation-page" data-page-index="5">
            <div class="progress-indicator">Step 5 of 9: Stakeholder Value & Impact</div> <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 text-center">Dimension 4: Stakeholder Value & Impact</h1> <form class="dimension-form space-y-8"> <fieldset data-dimension="value"> <legend class="fieldset-legend">Evaluation Questions</legend> <p class="dimension-description">The potential benefits and positive effects...</p> <div class="question-item"> <span class="question-label">Value for Students <span class="info-icon-container">...</span></span> <p class="question-description">How significantly could AI enhance...</p> <div class="scale-container"> <label><input type="radio" name="value_student" value="1" required> 1: Low</label> <label><input type="radio" name="value_student" value="2"> 2: Some</label> <label><input type="radio" name="value_student" value="3"> 3: Moderate</label> <label><input type="radio" name="value_student" value="4"> 4: Significant</label> <label><input type="radio" name="value_student" value="5" required> 5: High</label> </div> </div> <div class="question-item"> <span class="question-label">Value for Staff (Faculty/Admin/Etc.) <span class="info-icon-container">...</span></span> <p class="question-description">How significantly could AI reduce tedious workload...</p> <div class="scale-container"> <label><input type="radio" name="value_staff" value="1" required> 1: Low</label> <label><input type="radio" name="value_staff" value="2"> 2: Some</label> <label><input type="radio" name="value_staff" value="3"> 3: Moderate</label> <label><input type="radio" name="value_staff" value="4"> 4: Significant</label> <label><input type="radio" name="value_staff" value="5" required> 5: High</label> </div> </div> <div class="question-item"> <span class="question-label">Value for Institution <span class="info-icon-container">...</span></span> <p class="question-description">How significantly could AI improve operational efficiency...</p> <div class="scale-container"> <label><input type="radio" name="value_institution" value="1" required> 1: Low</label> <label><input type="radio" name="value_institution" value="2"> 2: Some</label> <label><input type="radio" name="value_institution" value="3"> 3: Moderate</label> <label><input type="radio" name="value_institution" value="4"> 4: Significant</label> <label><input type="radio" name="value_institution" value="5" required> 5: High</label> </div> </div> <div class="question-item"> <span class="question-label">Alignment with Mission/Strategic Goals <span class="info-icon-container">...</span></span> <p class="question-description">How well does using AI for this task align...</p> <div class="scale-container"> <label><input type="radio" name="value_alignment" value="1" required> 1: Poor Alignment</label> <label><input type="radio" name="value_alignment" value="2"> 2: Limited Alignment</label> <label><input type="radio" name="value_alignment" value="3"> 3: Neutral/Moderate</label> <label><input type="radio" name="value_alignment" value="4"> 4: Good Alignment</label> <label><input type="radio" name="value_alignment" value="5" required> 5: Strong Alignment</label> </div> </div> <div id="stakeholderPrompts" class="hidden mt-4"></div> <div class="mt-6"> <label id="notesValueLabel" for="notesValue" class="block text-sm font-medium text-gray-700 mb-1">Key Impacts (Positive/Negative) & Stakeholder Notes:</label> <textarea id="notesValue" name="notesValue" rows="3" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></textarea> </div> <div class="dimension-score-display mt-auto">Dimension Score (Avg):<span class="score-value" id="score_value">N/A</span></div> </fieldset> <div class="page-navigation"> <button type="button" data-target-page="evaluationPage_Ethics" class="action-button back-button navigate-button">← Back</button> <button type="button" data-target-page="evaluationPage_Human" class="action-button nav-button navigate-button">Next →</button> </div> </form>
        </div>
        <div id="evaluationPage_Human" class="page evaluation-page" data-page-index="6">
            <div class="progress-indicator">Step 6 of 9: Human Element Requirement</div> <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 text-center">Dimension 5: Human Element Requirement</h1> <form class="dimension-form space-y-8"> <fieldset data-dimension="human"> <legend class="fieldset-legend">Evaluation Questions</legend> <p class="dimension-description">The degree to which inherently human skills...</p> <div class="question-item"> <span class="question-label">Need for Empathy & Interpersonal Skills <span class="info-icon-container">...</span></span> <p class="question-description">How crucial are understanding emotions...</p> <div class="scale-container"> <label><input type="radio" name="human_empathy" value="1" required> 1: Minimal</label> <label><input type="radio" name="human_empathy" value="2"> 2: Slight</label> <label><input type="radio" name="human_empathy" value="3"> 3: Moderate</label> <label><input type="radio" name="human_empathy" value="4"> 4: High</label> <label><input type="radio" name="human_empathy" value="5"> 5: Essential</label> </div> </div> <div class="question-item"> <span class="question-label">Need for Mentorship & Guidance <span class="info-icon-container">...</span></span> <p class="question-description">Does the task involve personalized coaching...</p> <div class="scale-container"> <label><input type="radio" name="human_mentorship" value="1" required> 1: Minimal</label> <label><input type="radio" name="human_mentorship" value="2"> 2: Slight</label> <label><input type="radio" name="human_mentorship" value="3"> 3: Moderate</label> <label><input type="radio" name="human_mentorship" value="4"> 4: High</label> <label><input type="radio" name="human_mentorship" value="5"> 5: Essential</label> </div> </div> <div class="question-item"> <span class="question-label">Need for Nuanced Judgment & Contextual Understanding <span class="info-icon-container">...</span></span> <p class="question-description">How much does the task require interpreting subtle cues...</p> <div class="scale-container"> <label><input type="radio" name="human_judgment" value="1" required> 1: Minimal</label> <label><input type="radio" name="human_judgment" value="2"> 2: Slight</label> <label><input type="radio" name="human_judgment" value="3"> 3: Moderate</label> <label><input type="radio" name="human_judgment" value="4"> 4: High</label> <label><input type="radio" name="human_judgment" value="5"> 5: Essential</label> </div> </div> <div class="question-item"> <span class="question-label">Need for High-Stakes or Sensitive Communication <span class="info-icon-container">...</span></span> <p class="question-description">Does the task involve delivering difficult news...</p> <div class="scale-container"> <label><input type="radio" name="human_communication" value="1" required> 1: Minimal</label> <label><input type="radio" name="human_communication" value="2"> 2: Slight</label> <label><input type="radio" name="human_communication" value="3"> 3: Moderate</label> <label><input type="radio" name="human_communication" value="4"> 4: High</label> <label><input type="radio" name="human_communication" value="5"> 5: Essential</label> </div> </div> <div class="mt-6"> <label for="notesHuman" class="block text-sm font-medium text-gray-700 mb-1">Notes/Rationale for Human Element:</label> <textarea id="notesHuman" name="notesHuman" rows="3" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></textarea> </div> <div class="dimension-score-display mt-auto">Dimension Score (Max):<span class="score-value" id="score_human">N/A</span></div> </fieldset> <div class="page-navigation"> <button type="button" data-target-page="evaluationPage_Value" class="action-button back-button navigate-button">← Back</button> <button type="button" data-target-page="evaluationPage_Feasibility" class="action-button nav-button navigate-button">Next →</button> </div> </form>
        </div>
        <div id="evaluationPage_Feasibility" class="page evaluation-page" data-page-index="7">
            <div class="progress-indicator">Step 7 of 9: Feasibility & Implementation</div> <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 text-center">Dimension 6: Feasibility & Implementation</h1> <form id="evaluationForm" class="dimension-form space-y-8"> <fieldset data-dimension="feasibility"> <legend class="fieldset-legend">Evaluation Questions</legend> <p class="dimension-description">The practical and logistical aspects...</p> <div class="question-item"> <span class="question-label">Technology Maturity & Reliability <span class="info-icon-container">...</span></span> <p class="question-description">How proven, stable, and reliable...</p> <div class="scale-container"> <label><input type="radio" name="feasibility_tech" value="1" required> 1: Low</label> <label><input type="radio" name="feasibility_tech" value="2"> 2: Emerging/Uncertain</label> <label><input type="radio" name="feasibility_tech" value="3"> 3: Available but Niche</label> <label><input type="radio" name="feasibility_tech" value="4"> 4: Available and Proven</label> <label><input type="radio" name="feasibility_tech" value="5" required> 5: Mature and Reliable</label> </div> </div> <div class="question-item"> <span class="question-label">Data Availability, Quality & Appropriateness <span class="info-icon-container">...</span></span> <p class="question-description">Is sufficient, high-quality, relevant...</p> <div class="scale-container"> <label><input type="radio" name="feasibility_data" value="1" required> 1: Low</label> <label><input type="radio" name="feasibility_data" value="2"> 2: Requires Significant Effort</label> <label><input type="radio" name="feasibility_data" value="3"> 3: Available but Needs Prep</label> <label><input type="radio" name="feasibility_data" value="4"> 4: Mostly Available/Clean</label> <label><input type="radio" name="feasibility_data" value="5" required> 5: Readily Available/High Quality</label> </div> </div> <div class="question-item"> <span class="question-label">Cost-Effectiveness & Resource Availability <span class="info-icon-container">...</span></span> <p class="question-description">Are the expected benefits likely to justify...</p> <div class="scale-container"> <label><input type="radio" name="feasibility_cost" value="1" required> 1: Low ROI / High Cost</label> <label><input type="radio" name="feasibility_cost" value="2"> 2: Uncertain ROI / Moderate Cost</label> <label><input type="radio" name="feasibility_cost" value="3"> 3: Neutral / Costs Balanced by Benefits</label> <label><input type="radio" name="feasibility_cost" value="4"> 4: Good ROI / Manageable Cost</label> <label><input type="radio" name="feasibility_cost" value="5" required> 5: High ROI / Low Cost</label> </div> </div> <div class="question-item"> <span class="question-label">Integration & Policy Alignment <span class="info-icon-container">...</span></span> <p class="question-description">How easily can the AI be integrated...</p> <div class="scale-container"> <label><input type="radio" name="feasibility_integration" value="1" required> 1: Difficult Integration / Policy Conflicts</label> <label><input type="radio" name="feasibility_integration" value="2"> 2: Requires Major Changes</label> <label><input type="radio" name="feasibility_integration" value="3"> 3: Possible with Some Work</label> <label><input type="radio" name="feasibility_integration" value="4"> 4: Relatively Easy Integration</label> <label><input type="radio" name="feasibility_integration" value="5" required> 5: Seamless Integration / Aligned Policy</label> </div> </div> <div class="mt-6"> <label for="notesFeasibility" class="block text-sm font-medium text-gray-700 mb-1">Key Barriers & Resource Notes:</label> <textarea id="notesFeasibility" name="notesFeasibility" rows="3" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"></textarea> </div> <div class="dimension-score-display mt-auto">Dimension Score (Avg):<span class="score-value" id="score_feasibility">N/A</span></div> </fieldset> <div class="page-navigation"> <button type="button" data-target-page="evaluationPage_Human" class="action-button back-button navigate-button">← Back</button> <button type="submit" class="action-button submit-button">Calculate & View Results →</button> </div> </form>
        </div>

         <!-- Results Page -->
         <div id="resultsPage" class="page" data-page-index="8">
            <!-- Content as before -->
           <div class="progress-indicator">Step 8 of 9: Evaluation Result</div><h1 class="text-2xl md:text-3xl font-bold text-gray-900 mb-4 text-center">Evaluation Result</h1><div id="resultArea" class="mt-6"><div id="resultBox" class="result-default max-w-3xl mx-auto"><p id="resultCategory" class="font-bold text-lg mb-2">Suggested Category: [Calculating...]</p><p id="resultRationale" class="text-gray-700 text-base">Rationale: [Calculating...]</p><p id="resultDisclaimer" class="text-sm text-gray-600 mt-4 italic"></p></div><div id="radarChartContainer"><canvas id="myRadarChart"></canvas></div></div>
           <!-- Add instruction for the new export method -->
           <p id="exportInstructions" class="text-center text-sm text-gray-600 mt-2 hidden">Report opened in a new tab. Use your browser's Print function (Ctrl+P or Cmd+P) and select 'Save as PDF'.</p>
           <div class="page-navigation"> <button type="button" data-target-page="evaluationPage_Feasibility" class="action-button back-button navigate-button">← Back to Feasibility</button> <div> <button type="button" id="exportPdfButton" class="action-button export-button">Open Printable Report</button> <button type="button" data-target-page="landingPage" class="action-button back-button navigate-button ml-4">← Start New Evaluation</button> </div> </div>
        </div>

         <!-- PDF Content Area (No longer used for direct PDF generation) -->
         <!-- <div id="pdfContent" class="hidden"></div> -->

    </div> <!-- Close main-container -->

     <script>
        // --- Initialization ---
        const landingPage = document.getElementById('landingPage');
        const taskIdentificationPage = document.getElementById('taskIdentificationPage');
        const resultsPage = document.getElementById('resultsPage');
        const dimensionPages = document.querySelectorAll('.page.evaluation-page'); // More specific selector
        const taskIdentificationForm = document.getElementById('taskIdentificationForm');
        const evaluationForm = document.getElementById('evaluationForm');
        const resultArea = document.getElementById('resultArea');
        const resultBox = document.getElementById('resultBox');
        const resultCategory = document.getElementById('resultCategory');
        const resultRationale = document.getElementById('resultRationale');
        const resultDisclaimer = document.getElementById('resultDisclaimer');
        const exportPdfButton = document.getElementById('exportPdfButton');
        const exportInstructions = document.getElementById('exportInstructions'); // Get the instructions element
        // pdfContentDiv is no longer needed for direct generation
        const radarChartCanvas = document.getElementById('myRadarChart');
        let myRadarChart = null;
        const stakeholderCheckboxes = taskIdentificationForm.querySelectorAll('input[name="stakeholder"]');
        const otherStakeholderCheck = document.getElementById('stakeholderOtherCheck');
        const otherStakeholderInput = document.getElementById('otherStakeholderInput');
        const stakeholderPromptsDiv = document.getElementById('stakeholderPrompts');
        const notesValueLabel = document.getElementById('notesValueLabel');
        const navigateButtons = document.querySelectorAll('.navigate-button');
        let currentResultData = null; // Still stores chartImageBase64
        let dimensionScores = { nature: null, risk: null, ethics: null, value: null, human: null, feasibility: null };
        const dimensionDescriptions = { /* ... descriptions ... */ };

        // --- Navigation Logic ---
        function showPage(pageId) {
            exportInstructions.classList.add('hidden'); // Hide instructions when navigating away
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            const pageToShow = document.getElementById(pageId);
            if (pageToShow) {
                pageToShow.classList.add('active');
                const progressIndicator = pageToShow.querySelector('.progress-indicator');
                 if (progressIndicator) {
                    const pageIndex = pageToShow.dataset.pageIndex;
                    if (pageIndex) {
                        const totalSteps = 9;
                         let stepName = progressIndicator.textContent.split(': ')[1] || '';
                        if (!stepName && pageToShow.querySelector('h1')) { const titleText = pageToShow.querySelector('h1').textContent; const parts = titleText.split(': '); if (parts.length > 1) stepName = parts[1]; else stepName = titleText; } else if (!stepName) { stepName = "Current Step"; }
                        progressIndicator.textContent = `Step ${pageIndex} of ${totalSteps}: ${stepName}`;
                    }
                 }
                if (myRadarChart && pageId !== 'resultsPage') { try { myRadarChart.destroy(); } catch(e) {} myRadarChart = null; }
            } else { console.error("Target page not found:", pageId); landingPage.classList.add('active'); }
            window.scrollTo(0, 0);
        }

        // --- Event Listeners & Helpers (Navigation, Radio buttons, Stakeholders, Scores) ---
        // These remain largely the same as the previous version. Minor tweaks for robustness.
        navigateButtons.forEach(button => { /* ... event listener ... */ });
        function getRadioValueFromPage(pageId, name) { /* ... */ }
        function getRadioLabelFromPage(pageId, name) { /* ... */ }
        function getDimensionQuestionData(dimensionName) { /* ... */ } // Ensure this captures the question text correctly for the report
        function getNotesForDimension(dimensionName) { /* ... */ }
        function getSelectedStakeholders() { /* ... */ }
        function updateStakeholderPrompts() { /* ... */ }
        function calculateNatureScore() { /* ... */ }
        function calculateRiskScore() { /* ... */ }
        function calculateEthicsScore() { /* ... */ }
        function calculateValueScore() { /* ... */ }
        function calculateHumanScore() { /* ... */ }
        function calculateFeasibilityScore() { /* ... */ }
        function updateScoreDisplay(dimensionName, score) { /* ... */ }
        function renderRadarChart(scores, canvasElement, noAnimation = false) { /* ... */ }
        document.body.addEventListener('change', (event) => { /* ... event listener ... */ });
        otherStakeholderInput.addEventListener('input', () => { /* ... event listener ... */ });

        // --- Evaluation Form Submission Handler (Stores chart image) ---
        evaluationForm.addEventListener('submit', async function(event) {
            event.preventDefault();
            Object.keys(dimensionScores).forEach(dim => { const functionName = `calculate${dim.charAt(0).toUpperCase() + dim.slice(1)}Score`; if (typeof window[functionName] === 'function') { dimensionScores[dim] = window[functionName](); } else { dimensionScores[dim] = null; } });
            const allScoresCalculated = Object.values(dimensionScores).every(score => score !== null && !isNaN(score));
            if (!allScoresCalculated) { let missingDims = Object.keys(dimensionScores).filter(dim => dimensionScores[dim] === null || isNaN(dimensionScores[dim])); alert(`It seems some questions might be unanswered in dimension(s): ${missingDims.join(', ')}. Please go back...`); return; }

            // --- Heuristic Logic ---
            const HIGH_RISK_THRESHOLD = 4; const MEDIUM_RISK_THRESHOLD = 3; const HIGH_ETHICS_THRESHOLD = 4; const MEDIUM_ETHICS_THRESHOLD = 3; const ESSENTIAL_HUMAN_THRESHOLD = 5; const IMPORTANT_HUMAN_THRESHOLD = 4; const HIGH_FEASIBILITY_THRESHOLD = 4; const LOW_FEASIBILITY_THRESHOLD = 2; const MEDIUM_VALUE_THRESHOLD = 2.5; const HIGH_AUTOMATABILITY_NATURE_THRESHOLD = 3.5;
            let suggestedCategory = "Undetermined"; let rationale = ""; let categoryClass = "result-default";
             // (Heuristic logic block remains the same)
            if (dimensionScores.risk >= HIGH_RISK_THRESHOLD || dimensionScores.ethics >= HIGH_ETHICS_THRESHOLD || dimensionScores.human >= ESSENTIAL_HUMAN_THRESHOLD) { suggestedCategory = "Human-Led (No/Minimal AI)"; rationale = `Based on a high score in Risk (${dimensionScores.risk}), Ethics (${dimensionScores.ethics}), or Human Element Requirement (${dimensionScores.human}), this task is best kept human-led...`; categoryClass = "result-human-led";
            } else if (dimensionScores.risk >= MEDIUM_RISK_THRESHOLD || dimensionScores.ethics >= MEDIUM_ETHICS_THRESHOLD || dimensionScores.human >= IMPORTANT_HUMAN_THRESHOLD || dimensionScores.feasibility <= LOW_FEASIBILITY_THRESHOLD) { suggestedCategory = "AI-Assisted (Human in Control)"; rationale = `Moderate scores in Risk (${dimensionScores.risk}), Ethics (${dimensionScores.ethics}), or Human Element (${dimensionScores.human}), or low Feasibility (${dimensionScores.feasibility?.toFixed(2)}) suggest AI could assist...`; categoryClass = "result-ai-assisted";
            } else if (dimensionScores.nature >= HIGH_AUTOMATABILITY_NATURE_THRESHOLD && dimensionScores.feasibility >= HIGH_FEASIBILITY_THRESHOLD && dimensionScores.value > MEDIUM_VALUE_THRESHOLD) {
                 if (dimensionScores.risk < MEDIUM_RISK_THRESHOLD && dimensionScores.ethics < MEDIUM_ETHICS_THRESHOLD && dimensionScores.human < IMPORTANT_HUMAN_THRESHOLD) { suggestedCategory = "Full Automation (Minimal Oversight Post-Setup)"; rationale = `Very low scores in Risk (${dimensionScores.risk}), Ethics (${dimensionScores.ethics}), and Human Element Requirement (${dimensionScores.human}), alongside high feasibility...`; categoryClass = "result-full-automation";
                 } else { suggestedCategory = "High Automation Potential (Human Supervising)"; rationale = `While feasibility (${dimensionScores.feasibility?.toFixed(2)}), value (${dimensionScores.value?.toFixed(2)}), and task nature (${dimensionScores.nature?.toFixed(2)}) are favorable, some remaining factors...`; categoryClass = "result-high-automation"; }
            } else { suggestedCategory = "AI-Assisted (Human in Control)"; rationale = `The combination of scores across dimensions (Nature: ${dimensionScores.nature?.toFixed(2)}, Risk: ${dimensionScores.risk}, Ethics: ${dimensionScores.ethics}, Value: ${dimensionScores.value?.toFixed(2)}, Human: ${dimensionScores.human}, Feasibility: ${dimensionScores.feasibility?.toFixed(2)}) indicates that while some aspects might be automatable...`; categoryClass = "result-ai-assisted"; }

            // --- Display Results ---
            resultCategory.textContent = `Suggested Category: ${suggestedCategory}`;
            resultRationale.textContent = `Rationale: ${rationale}`;
            resultDisclaimer.textContent = "Disclaimer: This is a preliminary suggestion...";
            resultBox.className = ''; resultBox.classList.add('resultBox', 'max-w-3xl', 'mx-auto', categoryClass);

            const mainChartInstance = renderRadarChart(dimensionScores, radarChartCanvas);
             await new Promise(resolve => setTimeout(resolve, 100)); // Ensure chart renders
             let chartImageBase64 = null;
             if (mainChartInstance && typeof mainChartInstance.toBase64Image === 'function') { try { chartImageBase64 = mainChartInstance.toBase64Image('image/png', 1.0); } catch (e) { console.error("Could not get chart image:", e); } }

             // --- Store results ---
             currentResultData = {
                 taskName: document.getElementById('taskName').value, evaluator: document.getElementById('evaluator').value, evalDate: document.getElementById('evalDate').value, stakeholders: getSelectedStakeholders(),
                 dimensions: { /* ... dimension data using getDimensionQuestionData ... */
                     nature: { score: dimensionScores.nature, description: dimensionDescriptions.nature, questions: getDimensionQuestionData('nature'), notes: getNotesForDimension('nature') },
                     risk: { score: dimensionScores.risk, description: dimensionDescriptions.risk, questions: getDimensionQuestionData('risk'), notes: getNotesForDimension('risk') },
                     ethics: { score: dimensionScores.ethics, description: dimensionDescriptions.ethics, questions: getDimensionQuestionData('ethics'), notes: getNotesForDimension('ethics') },
                     value: { score: dimensionScores.value, description: dimensionDescriptions.value, questions: getDimensionQuestionData('value'), notes: getNotesForDimension('value') },
                     human: { score: dimensionScores.human, description: dimensionDescriptions.human, questions: getDimensionQuestionData('human'), notes: getNotesForDimension('human') },
                     feasibility: { score: dimensionScores.feasibility, description: dimensionDescriptions.feasibility, questions: getDimensionQuestionData('feasibility'), notes: getNotesForDimension('feasibility') }
                  },
                 suggestedCategory: suggestedCategory, rationale: rationale, disclaimer: "Disclaimer: This is a preliminary suggestion...", chartImageBase64: chartImageBase64 };
            showPage('resultsPage');
        });


        // --- Export to New Tab Function ---
        function exportToHtmlTab() {
            if (!currentResultData) { alert("Cannot export - results not calculated yet."); return; }
            if (!currentResultData.chartImageBase64) { alert("Chart image is not available for export. Please try recalculating results."); return; }

            // 1. Get necessary CSS styles for the report
             // IMPORTANT: Manually copy the relevant CSS rules from the <style> block
             // that start with `.printable-report` or are needed for its children.
             // Using regex or complex parsing is fragile. Best to define them here.
            const reportStyles = `
                body { font-family: sans-serif; margin: 0; padding: 0; }
                .printable-report { padding: 20px; color: #333; background: white; max-width: 8.5in; margin: 0 auto; }
                .printable-report h1 { font-size: 18pt; margin-bottom: 15px; color: #111; }
                .printable-report h2 { font-size: 14pt; margin-top: 20px; margin-bottom: 10px; border-bottom: 1px solid #ccc; padding-bottom: 5px; color: #222; page-break-after: avoid; }
                .printable-report h3 { font-size: 12pt; margin-top: 15px; margin-bottom: 5px; color: #444; page-break-after: avoid; }
                .printable-report .dimension-desc-pdf { font-size: 10pt; font-weight: bold; color: #333; margin-bottom: 12px; }
                .printable-report p { font-size: 10pt; line-height: 1.4; margin-bottom: 8px; }
                .printable-report .label { font-weight: bold; }
                .printable-report .notes { font-style: italic; color: #555; margin-left: 15px; font-size: 9pt; background-color: #f8f8f8; padding: 5px; border-radius: 3px; margin-top: 5px; page-break-inside: avoid; }
                .printable-report .result-section { margin-top: 25px; padding: 15px; border: 1px solid #ddd; background-color: #f9f9f9; page-break-inside: avoid; border-radius: 4px; }
                .printable-report .result-category { font-size: 14pt; font-weight: bold; margin-bottom: 10px; }
                .printable-report .result-rationale { font-size: 10pt; }
                .printable-report .result-disclaimer { font-size: 8pt; color: #777; margin-top: 15px; }
                .printable-report .question-block { margin-bottom: 10px; padding-bottom: 5px; border-bottom: 1px dotted #eee; page-break-inside: avoid; }
                .printable-report .question-block:last-of-type { border-bottom: none; }
                .printable-report .question-text { font-weight: bold; font-size: 10pt; margin-bottom: 2px;}
                .printable-report .question-desc-pdf { font-size: 8.5pt; color: #666; margin-bottom: 4px; }
                .printable-report .question-answer { margin-left: 10px; font-size: 10pt; }
                .printable-report .dimension-score-pdf { font-weight: bold; font-size: 11pt; margin-top: 5px; color: #0056b3; text-align: right; }
                .printable-report .stakeholder-list-pdf { margin-top: 5px; font-size: 10pt; }
                .printable-report .chart-container-pdf { width: 100%; max-width: 450px; margin: 20px auto; page-break-inside: avoid; text-align: center; }
                .printable-report .chart-container-pdf img { max-width: 100%; height: auto; display: inline-block; }
                @media print {
                     body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
                     .printable-report { box-shadow: none; border: none; margin: 0; max-width: 100%; }
                     /* Add any other print-specific overrides if needed */
                 }
            `;

            // 2. Prepare report body HTML
            let reportBodyHTML = `<div class="printable-report">`;
            reportBodyHTML += `<h1>AI Task Taxonomy Evaluation Report</h1><h2>Task Identification</h2> <p><span class="label">Task Name:</span> ${currentResultData.taskName || 'N/A'}</p> <p><span class="label">Evaluator(s):</span> ${currentResultData.evaluator || 'N/A'}</p> <p><span class="label">Date:</span> ${currentResultData.evalDate || 'N/A'}</p> <p class="stakeholder-list-pdf"><span class="label">Key Stakeholders:</span> ${currentResultData.stakeholders.length > 0 ? currentResultData.stakeholders.join(', ') : 'None selected'}</p>`;
            reportBodyHTML += `<h2>Dimension Scores Overview</h2><div class="chart-container-pdf"><img src="${currentResultData.chartImageBase64}" alt="Radar chart of dimension scores"></div>`;
            reportBodyHTML += `<h2>Dimension Evaluation Details</h2>`;
            let dimensionIndex = 1;
            const dimensionOrder = ['nature', 'risk', 'ethics', 'value', 'human', 'feasibility'];
            for (const key of dimensionOrder) {
                 const data = currentResultData.dimensions[key]; if (!data) continue;
                 const title = key.charAt(0).toUpperCase() + key.slice(1);
                 let scoreDisplay = 'N/A'; if (data.score !== null && !isNaN(data.score)) { scoreDisplay = (key === 'risk' || key === 'ethics' || key === 'human') ? data.score.toString() : data.score.toFixed(2); }
                 reportBodyHTML += `<h3>${dimensionIndex}. ${title}</h3>`;
                 reportBodyHTML += `<p class="dimension-desc-pdf">${data.description || ''}</p>`;
                 const questionKeys = Object.keys(data.questions || {});
                 for (const qKey of questionKeys) {
                     const qData = data.questions[qKey]; if(!qData) continue;
                     // Use qData.questionText now
                     reportBodyHTML += `<div class="question-block"><p class="question-text">${qData.questionText || qKey}:</p>${qData.description ? `<p class="question-desc-pdf">${qData.description}</p>` : ''}<p class="question-answer">${qData.label || 'N/A'} (Score: ${qData.value ?? 'N/A'})</p></div>`;
                 }
                 reportBodyHTML += `<p class="notes"><span class="label">Notes:</span> ${data.notes ? data.notes.replace(/\n/g, '<br>') : 'None'}</p>`; // Preserve line breaks in notes
                 reportBodyHTML += `<p class="dimension-score-pdf">Overall Dimension Score: ${scoreDisplay}</p>`;
                 dimensionIndex++;
            }
            reportBodyHTML += `<div class="result-section"><h2>Evaluation Result</h2><p class="result-category"><span class="label">Suggested Category:</span> ${currentResultData.suggestedCategory}</p><p class="result-rationale"><span class="label">Rationale:</span> ${currentResultData.rationale}</p><p class="result-disclaimer">${currentResultData.disclaimer}</p></div>`;
            reportBodyHTML += `</div>`; // Close printable-report

            // 3. Open new window and write content
            const reportWindow = window.open('', '_blank');
            if (!reportWindow) {
                alert("Could not open new window. Please check your browser's popup blocker settings.");
                return;
            }
            reportWindow.document.write(`
                <!DOCTYPE html>
                <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <title>Evaluation Report: ${currentResultData.taskName || 'Task'}</title>
                    <style>${reportStyles}</style>
                </head>
                <body>
                    ${reportBodyHTML}
                </body>
                </html>
            `);
            reportWindow.document.close(); // Important: Finalizes the document writing

            // Optional: Try to trigger print dialog after a short delay
            // setTimeout(() => {
            //     try { reportWindow.print(); } catch (e) { console.warn("Could not automatically trigger print dialog.", e); }
            // }, 500);

             // Show instructions on the original page
             exportInstructions.classList.remove('hidden');

        }

        // --- Attach Export Function to Button ---
        exportPdfButton.addEventListener('click', exportToHtmlTab);


        // --- Initial Setup ---
        document.getElementById('evalDate').valueAsDate = new Date();
        updateStakeholderPrompts();
        showPage('landingPage');

    </script>

</body>
</html>